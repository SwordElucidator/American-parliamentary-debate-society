<%= javascript_include_tag "index" %>
<div class = "debate_title">APDS Mockup Debate Signups</div>
<%= render 'message'%>
<div class = "boxed", id = "boxed">
<% if Debate.all.length != 0%>
  <table class = "table-apds table table-striped" style="width:auto;">
  <%= render 'head' %>
  <tb>
    <% @debate.each do |debate| %>
      <tr>
        <td><p style="width:170px;"><%= debate.topic%></p></td>    
        <td><p style="width:95px;"><%= debate.time %></p></td>
        <% @slottype.each do |slottype|%>
          <td>
            <p style="width:251px;">
            <% debate.slots.each do |slot| %>
              <div class="btn-group btn-group-sm">
                <% if slot.slottype == slottype %>
                  <% if slot.status == "empty"%>
                    <h4><div class = "register_" + <% slot.id %>><%= button_to "Register", change_registration_path(slot.id), :method => :post, :remote => true, :class => 'change_registration', class: "btn btn-success btn-sm" %></div></h4>
                  <% else%>
                    <% if current_user.slots.include?slot %>
                      <h4><%= button_to "Cancel", change_registration_path(slot.id), class: "btn btn-danger btn-sm" %></h4>
                    <% else %>
                      <h4><span class="label label-default customlabel"><%= Debate.parse_name(User.find_by_id(slot.user_id)) %></span></h4>
                    <% end%>
                  <% end%>
                <% end%>
              </div>
            <% end%>
            </p>
          </td>
        <% end %>
        <% if current_user.is_admin == true %>
          <td>
            <%= link_to update_debate_path(:id => debate.id) do %>
              <i class="glyphicon glyphicon-edit blue"></i>
            <% end %>
          </td>
        <%end%>
      </tr>
    <% end%>
  </tb>
  </table>
<% end%>
<% if current_user.is_admin == true %>
  <div class = "createdebate">
    <%= link_to "Create Debate", {:action => "create", :method => "get"}, class: "btn btn-primary btn-lg", role: "button" %>
  </div>
<% end%>
</div>
